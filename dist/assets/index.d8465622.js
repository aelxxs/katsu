const d=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(t=>{for(const e of t)if(e.type==="childList")for(const a of e.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function r(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerpolicy&&(e.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?e.credentials="include":t.crossorigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function s(t){if(t.ep)return;t.ep=!0;const e=r(t);fetch(t.href,e)}};d();const{init:l,component:u}=Lucia;l();const i=u({html:"",code:"",done:!1,make(){this.code="",this.html="",this.done=!1,window.history.pushState(null,"","/")},edit(){this.html="",this.done=!1,window.history.pushState(null,"","/")},async save(){if(this.code=="")return;const o=await fetch("/api/doc",{method:"POST",body:this.code}),{id:n,url:r}=await o.json();this.html=this.code,this.done=!0,window.history.pushState(null,"",`/${n}`)}});async function c(){const o=window.location.pathname;if(o=="/")return i.state.make();const[,n]=o.split("/");try{i.state.done=!0;const r=await fetch(`/api/doc/${n}`,{method:"GET"}),{doc:s}=await r.json();i.state.code=s,i.state.html=s}catch{window.history.pushState(null,"","/"),i.state.make()}}document.addEventListener("paste",o=>{var s;const r=((s=o.clipboardData)!=null?s:window.clipboardData).getData("text");i.state.code=r,o.preventDefault()});document.addEventListener("popstate",c);document.addEventListener("DOMContentLoaded",c,!1);i.mount("#app");
